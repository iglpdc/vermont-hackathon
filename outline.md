Cluster Data Management Using Version Control
=============================================

Libraries
---------
 * docopt


Desired Outcomes
----------------
 * Reduce time spent managing the submission and collection of data
   off HPC infrastructure.

Requirements
------------
 * push from clusters but pull from local machines

Initialize
----------
 * install local python scripts
 * make project directory structure
 * construct VC exclude file
    * possibly different levels of exclude (local, cluster)
 * create repository (git,svn,etc) with detailed README.md

Ideas
-----
 * some kind of project database keeping track of running jobs
 * submit script md5 hash is job name


Project.log
-----------
 * Accessed both on job creation or finish/fail
 * Details of all current or past jobs run in the project
 * distinction between new run and restart
 * keeps track of job state: created, submitted, running, finished, failed,
   deleted
 * use md5 hash generated by version control to name a pbs submit script
    * for jobarray, append unique integer
 * use hash as key for project.log dictionary
 * information on a given job
    * name: hash
    * state
    * hashes of any related/dependent commits

Create Project
-------------
 * Given a project name, create project structure
 * Create subproject with same name inside
 * If project exists, create subproject with second name passed
 * commit project with structure to repo
 * force creation of README.md file, provide skeleton file
   * include exact line needed to clone

Directory Structure
-------------------
    project/
        README.md
        src/
        results/
        subproject/
            ./
            README.md
            project.log
            executable.e
              "one executable for each project, tied to external repo"
            data/
              "not all under VC, contains input/output files""
            results/
              "contains results from data you want to keep and any processed data,
              plots, etc. Under version control"
            src/ 
               "scripts/programs belonging to this program, single use, etc.
                under VC"

Classes
-------
 * ScriptCreater (Adrian)
   * create the submit script
   * contains details of queueing programs

 * StructureCreater (Gonz)
   * create input files
   * create any directory structure in data/

 * JobCreater (Chris)
    1. takes script or creates new one via ScriptCreater
    2. requires structrue (either present or calls StructureCreater)
    3. commits to repo and gets hash
    4. update job state to created in project.log 

 * Submitter (Gonz)
    1. takes a created job with a unique hash
    2. generates a job name based on the hash
    3. submits a job to the cluster
    4. updates job state to submitted via project.log

 * UpdateState
    * tests the state of a unique job hash
    * updates project.log based on state if changed from submitted to running

 * ProjectLog
    * commit project.log to repo automatically

 * RepoMan
 * CopyResultsFromData
    * knows how to copy all data associated with a given hash from data/ to
      results/
